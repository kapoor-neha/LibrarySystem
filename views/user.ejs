<% include include/main-header %>
<style>
	.box-primary h4 {
    border-bottom: 1px solid #ddd;
    border-radius: 3px;
    font-size: 20px;
    margin: 7px 5px 0 0;
    padding: 9px;
}
.btn-bs-file{
    position:relative;
}
.btn-bs-file input[type="file"]{
    position: absolute;
    top: -9999999;
    filter: alpha(opacity=0);
    opacity: 0;
    width:0;
    height:0;
    outline: none;
	
    cursor: inherit;
}
</style>
</head>
<body class="hold-transition skin-blue sidebar-mini">
   	<div class="wrapper">
   		<!-- Header Starts here-->
  		<% include include/header %>
  		<!-- Header Ends here-->
  		
  		<!-- Sidebar Starts Here-->
  			<% include include/sidebar %>
    		<!-- Sidebar Ends Here-->
    		
    	<div class="content-wrapper">
    	  	<!-- Content Header (Page header) -->
    		<section class="content-header">
      			<h1>User <small><% if (typeof contentObj.firstname !== 'undefined' && contentObj.firstname !== null) { %><%= contentObj.firstname %><% } else{	%>Add new<% }%></small></h1>
      			<ol class="breadcrumb">
        			<% include include/dashboard-breadcrumb %>
        			<li class="active">User</li>
      			</ol>
    		</section>	
    		<section class="content">
      			<div class="row">
      				<div class="panel-body no-padding-top bg-white">
      					<% include include/display_returned_msg %>
            			<form class="form-horizontal" action="/save/user" method="POST" id="contentForm">
      					<div class="nav-tabs-custom">
      						<ul class="nav nav-tabs pull-left">
            					<li class="active"><a href="#first" data-toggle="tab">Details</a></li>
            					<% if (typeof contentObj._id !== 'undefined' && contentObj._id !== null) { %>
            					<li><a href="#third" data-toggle="tab">Issued Books</a></li>
            					<% } %>
							</ul>
							<div class="tab-content ">
								
								<div class="chart tab-pane active" id="first" ><div STYLE="margin-top:10px;">
            						<input type="hidden" class="form-control" id="data" name="data" value="">
            						<input type="hidden" class="form-control" id="table_name" name="table_name" value="users">
      								<input type="hidden" class="form-control" id="unique_field" name="unique_field" value="email">
      								<input type="hidden" class="form-control" id="id" name="id" value="<% if (typeof contentObj._id !== 'undefined' && contentObj._id !== null) { %><%= contentObj._id %><% } %>">
            						
                					<div class="row">
            						<div class="col-xs-12 col-md-6"><div class="box box-primary">
            						<h4>Basic Details</h4>
            						<div class="box-body"><div class="row"><div class=" col-sm-12 col-lg-12">
            						<div class="col-xs-12 col-md-8">                 					
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="first-name">Username<span class="required">*</span></label>
                  						<div class="col-md-9 col-lg-9">
                    						<input type="text" required="required" id="username" name="username" class="form-control col-md-5 col-xs-12" value="<% if (typeof contentObj.username !== 'undefined' && contentObj.username !== null) { %><%= contentObj.username %><% } %>">
                  						</div>
                					</div>
                					
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="first-name">First Name<span class="required">*</span></label>
                  						<div class="col-md-9 col-lg-9">
                    						<input type="text" required="required" id="firstname" name="firstname" class="form-control col-md-5 col-xs-12" value="<% if (typeof contentObj.firstname !== 'undefined' && contentObj.firstname !== null) { %><%= contentObj.firstname %><% } %>">
                  						</div>
                					</div>
                					
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="">Last Name<span class="required">*</span></label>
                  						<div class="col-md-9 col-lg-9">
                   							<input type="text"  required="required" class="form-control col-md-5 col-xs-12" id="lastname" name="lastname" value="<% if (typeof contentObj.lastname !== 'undefined' && contentObj.lastname !== null) { %><%= contentObj.lastname %><% } %>">
                  						</div>
                					</div>
                					</div>
                					<div class="col-xs-12 col-md-12">
                					
                					<div class="form-group">
    									<label for="" class="col-sm-2 control-label">Gender</label>
    									<div class="col-sm-9">
    										<div class="radio" STYLE="float:left; margin-right:10px;">
      		  									<label> <input type="radio" id="gender" name="gender" value="f" <% if (typeof contentObj.gender !== 'undefined' && contentObj.gender !== null && contentObj.gender == "f") { %>checked<% } %> > <strong style="font-weight:600">Female</strong></label>
    			  							</div>
				  							<div class="radio" STYLE="float:left;">
      		  									<label> <input type="radio" id="gender" name="gender" value="m" <% if (typeof contentObj.gender !== 'undefined' && contentObj.gender !== null && contentObj.gender == "m") { %>checked<% } %> > <strong style="font-weight:600">Male</strong></label>
    			  							</div>
										</div>
									</div>
                					<div class="form-group">
                  						<label class="control-label col-md-2" for="">Email <span class="required">*</span></label>
                  						<div class="col-md-9 col-lg-9">
                   							<input type="email"  required="required" class="form-control col-md-5 col-xs-12" id="email" name="email" value="<% if (typeof contentObj.email !== 'undefined' && contentObj.email !== null) { %><%= contentObj.email %><% } %>">
                  						</div>
                					</div>
                					<% if (typeof contentObj._id !== 'undefined' && contentObj._id !== null) { %>
                						<div class="form-group">
                  							<label class="control-label col-md-2" for="">Password<span class="required">*</span></label>
                  							<div class="col-md-6">
                   								<input type="password"  required="required" class="form-control col-md-5 col-xs-12" id="password" name="password" value="" disabled>
                  							</div>
                  							<div class="checkbox" STYLE="float:left; margin-right:10px;">
      		  									<label> <input type="checkbox" id="change_password" value="1" > <strong style="font-weight:600">Change Password</strong></label>
    			  							</div>
                						</div>
                							
                					<% }else{	%>
                					<div class="form-group">
                  						<label class="control-label col-md-2" for="">Password<span class="required">*</span></label>
                  						<div class="col-md-9 col-lg-9">
                   							<input type="password"  required="required" class="form-control col-md-5 col-xs-12" id="password" name="password" value="">
                  						</div>
                					</div>
                					<% } %>											
                					</div>        					
                            		</div></div>
                            		</div></div></div>
							        
                					<div class="col-xs-12 col-md-6"><div class="box box-primary">
            						<h4>Contact Details</h4>
            						<div class="box-body"><div class="row"><div class=" col-sm-12 col-lg-11">
            						
            						<div class="form-group">
                  						<label class="control-label col-md-3" for="">Contact number</label>
                  						<div class="col-md-6 col-lg-7">
                   							<input type="text" class="form-control col-md-5 col-xs-12" id="mobile" name="mobile" value="<% if (typeof contentObj.mobile !== 'undefined' && contentObj.mobile !== null) { %><%= contentObj.mobile %><% } %>">
                  						</div>
                					</div>
                							
                					<div class="form-group">
    									<label for="" class="col-sm-3 control-label">Address Line 1</label>
    									<div class="col-sm-9">
    										<textarea name="address_line_1" id="address_line_1" class="form-control"><% if (typeof contentObj.address_line_1 !== 'undefined' && contentObj.address_line_1 !== null) { %><%= contentObj.address_line_1  %><% } %></textarea>
      		  							</div>
									</div>
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="">County/State</label>
                  						<div class="col-md-6 col-lg-7">
                   							<input type="text" class="form-control col-md-5 col-xs-12" id="state" name="state" value="<% if (typeof contentObj.state !== 'undefined' && contentObj.state !== null) { %><%= contentObj.state %><% } %>">
                  						</div>
                					</div>
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="">Postcode</label>
                  						<div class="col-md-6 col-lg-7">
                   							<input type="text" class="form-control col-md-5 col-xs-12" id="postcode" name="postcode" value="<% if (typeof contentObj.postcode !== 'undefined' && contentObj.postcode !== null) { %><%= contentObj.postcode %><% } %>">
                  						</div>
                					</div>
                					
                					<div class="form-group">
                  						<label class="control-label col-md-3" for="first-name">Country</label>
                  						<div class="col-md-3 col-lg-7">
                  							<select id="country" name="country" class="form-control">
                    						
                    						</select>
                  						</div>
                					</div>
                					                					
                            		</div></div>
                            		</div></div></div>
                					</div>
                					<div class="row">
            						
                					<div class="col-xs-12 col-md-6"><div class="box box-primary">
							        <h4>Access Control</h4>
            						<div class="box-body"><div class="row"><div class=" col-sm-12 col-lg-12">
            					
							       	<div class="form-group">
    									<label for="" class="col-sm-3 control-label">Access Right</label>
    									<div class="col-sm-9">
    										<div class="radio" STYLE="float:left; margin-right:10px;">
      		  									<label> <input type="radio" id="access_right" name="access_right" value="1" <% if (typeof contentObj.access_right !== 'undefined' && contentObj.access_right !== null && contentObj.access_right == 1 && contentObj.access_right == "1") { %>checked<% } %> > <strong style="font-weight:600">Normal User</strong></label>
    			  							</div>
    			  							
    			  							<% if (typeof authenticatedUser.access_right !== 'undefined' && authenticatedUser.access_right !== null  && authenticatedUser.access_right == "11"  && authenticatedUser.access_right == 11) {	%>
            								<div class="radio" STYLE="float:left;">
      		  									<label> <input type="radio" id="access_right" name="access_right" value="11" <% if (typeof contentObj.access_right !== 'undefined' && contentObj.access_right !== null && contentObj.access_right == 11 && contentObj.access_right == "11") { %>checked<% } %> > <strong style="font-weight:600">Admin</strong></label>
    			  							</div>
    			  							<% } %>
										</div>
									</div>
									
                					<div class="form-group">
    									<label for="" class="col-sm-3 control-label"></label>
    									<div class="col-sm-9">
    										<div class="checkbox">
      		  									<label> <input type="checkbox" id="status" name="status" value="1" <% if (typeof contentObj.status !== 'undefined' && contentObj.status !== null && contentObj.status == 1) { %>checked<% } %> > <strong style="font-weight:600">Active</strong></label>
    			  							</div>
										</div>
									</div>
									
									</div></div>
                					</div></div></div>
                					</div>
                					
              					
              					</div></div>
              					<% if (typeof contentObj._id !== 'undefined' && contentObj._id !== null) { %>
              					
              					<div class="chart tab-pane" id="third" >
              						<div class="row" STYLE="margin-top:10px;" id="loadAvailabilityDiv">
              								
              						</div>
              						<div style="text-align:center;display:none;" id="display_more_btn">
										<a style="width: 60%; margin-bottom: 10px;" class="btn palette-carrot btn-warning" title="Load more" onclick="load_more_ava()" href="javascript:void(0);">
											Load more
										</a>
        							</div>
        							<div style="text-align:center" id="img_loading_div">
										Progress under work...<br /> <img id="imgAjaxLoading" src="img/loading.gif" width="109" height="25" style="border-width: 0px;">
									</div>
              					</div>
              					<% } %>
              					
              				</div>
              			</div>
              			
              			<div class="row">
            				<div class="form-group">
            					<div class="col-md-12 col-lg-12" align="center">
               						<div class="submit-btn-setting"> <button type="submit" class="btn btn-primary btn-color margin-right-5 btn-sm">Submit</button>
               							<% if (typeof contentObj._id !== 'undefined' && contentObj._id !== null) {	%>
               								<a href="/list/users" class="btn btn-danger btn-sm">Cancel</a>
               							<%	}else{	%>
               								<button type="reset" class="btn btn-danger btn-sm">Reset</button>
               							<% } %>
               						</div>
               					</div>
                			</div>
                		</div>
                					
              			</form>
              		</div>
      			</div>
    		</section>
    		<!--//body content--> 
  		</div>

<!-- Footer Starts Here-->
	<% include include/footer %>
<!-- Footer Ends Here-->
<!--//Main Content--> 
	</div>
<!-- Page-Level Plugin Scripts-->
<script src="js/jquery.validate.js"></script>
<script>
$(document).ready(function() {
	// validate form on keyup and submit
		$("#contentForm").validate({
			ignore: "",
			onkeyup: false,
			errorClass: 'error',
			validClass: 'valid',
			errorElement: "em",
			errorPlacement: function(error, element) {
				if (element.attr("name") == "access_right" || element.attr("name") == "status" ) {
      				$(element).closest('div').after(error);
   				} else {
					$(element).closest('div').append(error);
				}
			},
			onfocusout: false,
			invalidHandler: function(form, validator) {
				var errors = validator.numberOfInvalids();
				if (errors) {                    
					validator.errorList[0].element.focus();
				}
			},
			rules: {
				firstname: { required: true },
				lastname: { required: true },
				email: { required: true, email : true },
				password: { required: true },
				access_right: { required: true }
			},
			submitHandler: function(form) {
				dataAsJson('contentForm', form);
 			}
		});	
	$("#change_password").click(function() {
    	if ($('#change_password').is(':checked')) {
      		$('#password').removeAttr('disabled');
      	} else {
      		$('#password').attr('disabled', true);
    	}
    });
 
    $("#web_access").click(function() {
    	if ($('#web_access').is(':checked')) {
      		$('#allow_web_access').val(1);
      	} else {
      		$('#allow_web_access').val(0);
    	}
    });
});
</script>
</body>
</html>